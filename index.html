
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì°ì£¼ìì°¨ ìë®¬ë ì´í°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ìºë²ì¤ë¥¼ í¬í¨íë ì»¨íì´ë */
        #canvas-container {
            width: 100%;
            max-width: 800px;
            aspect-ratio: 16 / 10; /* ëë¹ ëë¹ ëì´ ë¹ì¨ ì ì§ */
            background-color: #0d1117; /* ì´ëì´ ì°ì£¼ ë°°ê²½ */
            margin: 0 auto;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        /* Tailwindìì ì ìíê¸° ì´ë ¤ì´ ì»¤ì¤í ì¬ë¼ì´ë ì¤íì¼ */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #fef3c7; /* yellow-100 */
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'space-dark': '#0d1117',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-900 text-white font-sans p-4 sm:p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-3xl sm:text-4xl font-bold text-center text-yellow-300 mb-6">ð­ ì°ì£¼ìì°¨ (Stellar Parallax) ìë®¬ë ì´í°</h1>
        
        <div class="flex flex-col lg:flex-row gap-6">
            
            <!-- ìë®¬ë ì´ì ìì­ -->
            <div class="lg:w-2/3">
                <div id="canvas-container">
                    <canvas id="parallaxCanvas"></canvas>
                </div>

                <!-- ì»¨í¸ë¡¤ í¨ë -->
                <div class="bg-gray-800 p-4 mt-6 rounded-xl shadow-lg">
                    <h2 class="text-xl font-semibold text-yellow-400 mb-4">âï¸ ìë®¬ë ì´ì ì¡°ì</h2>
                    
                    <div class="space-y-4">
                        <!-- ë³ X ê±°ë¦¬ ì¡°ì  -->
                        <div>
                            <label for="distanceSlider" class="block text-sm font-medium mb-1">ë³ X ê±°ë¦¬ ì¡°ì  (AU ëë¹ ìë ê±°ë¦¬)</label>
                            <input type="range" id="distanceSlider" min="200" max="600" value="350" step="10" 
                                class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                            <span id="distanceValue" class="text-sm text-gray-400 mt-1 block text-right">350</span>
                        </div>
                        
                        <!-- ì ëë©ì´ì ìë ì¡°ì  -->
                        <div>
                            <label for="speedSlider" class="block text-sm font-medium mb-1">ì§êµ¬ ê³µì  ìë</label>
                            <input type="range" id="speedSlider" min="0.001" max="0.02" value="0.005" step="0.001" 
                                class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                            <span id="speedValue" class="text-sm text-gray-400 mt-1 block text-right">0.005x</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì ë³´ íì ìì­ -->
            <div class="lg:w-1/3">
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg h-full">
                    <h2 class="text-xl font-semibold text-sky-400 mb-4">ð ì°ì£¼ìì°¨ì ìë¦¬</h2>
                    
                    <div class="space-y-4">
                        <div class="bg-gray-700 p-3 rounded-lg">
                            <h3 class="font-bold text-lg text-yellow-300">íµì¬ ê³µì</h3>
                            <p class="mt-1 text-sm">
                                <span class="font-mono bg-gray-600 p-1 rounded">
                                    $$d(\text{pc}) = \frac{1}{p(\text{arcsec})}$$
                                </span>
                            </p>
                            <p class="text-xs text-gray-400 mt-2">
                                * $d$ë ê±°ë¦¬(íì¹, pc), $p$ë ì°ì£¼ìì°¨(ì´, arcsec)
                            </p>
                        </div>

                        <div class="bg-gray-700 p-3 rounded-lg">
                            <h3 class="font-bold text-lg text-sky-300">íì¬ ê°</h3>
                            <ul class="text-sm space-y-2 mt-2">
                                <li id="starXData" class="text-orange-300 border-b border-gray-600 pb-1"></li>
                                <li id="starYData" class="text-yellow-300 border-b border-gray-600 pb-1"></li>
                            </ul>
                        </div>
                        
                        <div class="text-xs text-gray-400 pt-2">
                            <p>* **ì°ì£¼ìì°¨**ë ì§êµ¬ ê³µì  ê¶¤ëì ë°ì§ë¦(1AU)ì ë°ë³ì¼ë¡ íê³  ë³ê¹ì§ì ê±°ë¦¬ë¥¼ ëì´ë¡ íë ì§ê°ì¼ê°íìì ë³ì ìì¹ì ìë ê°ë($p$)ì ì ë°ìëë¤. ìë®¬ë ì´í°ììë ìê°ì ì¸ ì´í´ë¥¼ ëê¸° ìí´ $p$ë¥¼ ì§ê°ì¼ê°íì ê°ì¼ë¡ íìí©ëë¤.</p>
                            <p>* **ìì°¨ì í¬ê¸°**ë ë³ê¹ì§ì ê±°ë¦¬ê° ê°ê¹ì¸ìë¡ ì»¤ì§ëë¤. (ë³ X íì¸)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ìºë²ì¤ ì¤ì 
        const canvas = document.getElementById('parallaxCanvas');
        const ctx = canvas.getContext('2d');

        // ê³ ì ë ìë®¬ë ì´ì ì¢íê³ ì ì (íë©´ í¬ê¸° ë³íì ë¬´ê´íê² ë´ë¶ ë¹ì¨ ì ì§)
        const SIM_WIDTH = 800;
        const SIM_HEIGHT = 550;
        const SUN_POS = { x: SIM_WIDTH / 2, y: SIM_HEIGHT / 2 + 50 }; // íì ìì¹ë¥¼ ì½ê° ìëë¡ ì´ë
        const AU_CANVAS_RADIUS = 150; // 1 AUì í´ë¹íë ìºë²ì¤ ë¨ì ê±°ë¦¬

        // ìí ë³ì
        let earthAngle = 0; // ì§êµ¬ì íì¬ ê³µì  ê°ë (ë¼ëì)
        let animationSpeed = 0.005; // ê³µì  ìë (íë ìë¹ ë¼ëì)
        
        // ë³ ë°ì´í° ì´ê¸°ê°
        const STARS = [
            { name: 'ë³ X', distance: 350, color: '#f97316', id: 'starX' }, // orange-500
            { name: 'ë³ Y', distance: 600, color: '#facc15', id: 'starY' }  // yellow-400
        ];

        // --- ê³ì° ë° ë³í í¨ì ---
        
        // ì°ì£¼ìì°¨ ë° ê±°ë¦¬ ê³ì° í¨ì
        function calculateParallaxData(distance) {
            // p_rad = atan(AU / distance)
            const p_rad_visual = Math.atan(AU_CANVAS_RADIUS / distance);

            // ì¤ì  ê³¼íì  ê´ê³ë¥¼ ë°ìíê¸° ìí ì¤ì¼ì¼ë§ (1pc = 1 arcsec)
            // atan(1 AU / 1 pc) = 1 arcsec
            // ì¬ê¸°ì AU_CANVAS_RADIUSë¥¼ 1 AUë¡, distanceë¥¼ pc ë¨ìë¡ ê°ì í  ì ìì¼ë¯ë¡,
            // ìê°ì ì¸ p_rad_visualì ì´ì©íì¬ d=1/p ê³µìì ë§ê² p_arcsecë¥¼ "ìë®¬ë ì´ì"í©ëë¤.
            
            // ììì ì¤ì¼ì¼ í©í° (ìì°¨ë¥¼ ìê² ë§ë¤ì´ì arcsec ë¨ìì²ë¼ ë³´ì´ê² í¨)
            const PARALLAX_SCALE_FACTOR = 1000; 
            const p_arcsec = (p_rad_visual * 180 / Math.PI * 3600) / PARALLAX_SCALE_FACTOR;
            
            // ê±°ë¦¬(pc) = 1 / ì°ì£¼ìì°¨(arcsec)
            const distance_pc = 1 / p_arcsec;

            return {
                p_rad: p_rad_visual,
                p_arcsec: p_arcsec,
                distance_pc: distance_pc
            };
        }

        // --- ìºë²ì¤ í¬ê¸° ì¡°ì  ë° ì´ê¸°í ---

        function resizeCanvas() {
            const container = document.getElementById('canvas-container');
            // ìºë²ì¤ ë¬¼ë¦¬ì  í¬ê¸°ë¥¼ ì»¨íì´ëì ë§ì¶¤
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // --- ë ëë§ í¨ì ---

        function drawParallaxDiagram() {
            // 1. ìºë²ì¤ ì´ê¸°í ë° ë³í (íë©´ ì¤ì ì ë ¬ì ìí´)
            ctx.fillStyle = '#0d1117';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // SIM_WIDTH/SIM_HEIGHTë¥¼ ì¤ì  ìºë²ì¤ í¬ê¸°ì ë§ê² ì¤ì¼ì¼ë§ ë° ì´ë
            const scaleX = canvas.width / SIM_WIDTH;
            const scaleY = canvas.height / SIM_HEIGHT;
            const scale = Math.min(scaleX, scaleY); // ìµìê°ì¼ë¡ ë¹ì¨ ì ì§
            
            ctx.save();
            // ì¤ì ì ë ¬ ë° ì¤ì¼ì¼ ì ì©
            ctx.translate(canvas.width / 2 - (SIM_WIDTH / 2) * scale, canvas.height / 2 - (SIM_HEIGHT / 2) * scale);
            ctx.scale(scale, scale);
            
            // ê³ ì  ë°°ê²½ ë³ (ë°°ê²½ì ìí í¸)
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(SUN_POS.x, SUN_POS.y, 800, 0, Math.PI * 2);
            ctx.stroke();
            
            // 2. íì ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#fdb813'; // Sun color
            ctx.beginPath();
            ctx.arc(SUN_POS.x, SUN_POS.y, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'white';
            ctx.font = '14px Noto Sans KR';
            ctx.fillText('íì', SUN_POS.x + 20, SUN_POS.y);

            // 3. ì§êµ¬ ê¶¤ë ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#2563eb'; // blue-700
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(SUN_POS.x, SUN_POS.y, AU_CANVAS_RADIUS, 0, Math.PI * 2);
            ctx.stroke();

            // 4. ì§êµ¬ ìì¹ ê³ì°
            const earthX = SUN_POS.x + AU_CANVAS_RADIUS * Math.cos(earthAngle);
            const earthY = SUN_POS.y + AU_CANVAS_RADIUS * Math.sin(earthAngle);

            // 6ê°ì ì /í (A/B ì§ì )
            const angleA = Math.PI * 0; // A: 0 ë¼ëì (ì¤ë¥¸ìª½)
            const angleB = Math.PI * 1; // B: 180ë (ì¼ìª½)
            
            const earthAX = SUN_POS.x + AU_CANVAS_RADIUS * Math.cos(angleA);
            const earthAY = SUN_POS.y + AU_CANVAS_RADIUS * Math.sin(angleA);
            const earthBX = SUN_POS.x + AU_CANVAS_RADIUS * Math.cos(angleB);
            const earthBY = SUN_POS.y + AU_CANVAS_RADIUS * Math.sin(angleB);

            // 4-1. A ì§ì  ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#3b82f6';
            ctx.beginPath();
            ctx.arc(earthAX, earthAY, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'white';
            ctx.fillText('A', earthAX + 10, earthAY + 5);

            // 4-2. B ì§ì  ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#3b82f6';
            ctx.beginPath();
            ctx.arc(earthBX, earthBY, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'white';
            ctx.fillText('B', earthBX - 20, earthBY + 5);

            // 4-3. íì¬ ì§êµ¬ ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#3b82f6'; // blue-500
            ctx.beginPath();
            ctx.arc(earthX, earthY, 10, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'white';
            ctx.fillText('ì§êµ¬', earthX + 15, earthY + 5);


            // 5. ë³ ê·¸ë¦¬ê¸° ë° ìì°¨/ìì  íì
            STARS.forEach(star => {
                const data = calculateParallaxData(star.distance);
                star.data = data;
                
                // ë³ ìì¹ (Yì¶ì SIM_HEIGHT ì¤ì ê¸°ì¤, ë³ì ììª½ì ìì¹)
                const starYPos = SUN_POS.y - star.distance;
                const starPos = { x: SUN_POS.x, y: starYPos };

                // ë³ ê·¸ë¦¬ê¸°
                ctx.fillStyle = star.color;
                ctx.beginPath();
                ctx.arc(starPos.x, starPos.y, 12, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = 'white';
                ctx.font = '16px Noto Sans KR';
                ctx.fillText(star.name, starPos.x + 15, starPos.y + 5);

                // --- ì°ì£¼ìì°¨($p$) ê° íì (Sun-Star-Earth triangle) ---
                
                // íììì ë³ê¹ì§ì ê¸°ì¤ì  (ì¤ì ì ì )
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)';
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(SUN_POS.x, SUN_POS.y);
                ctx.lineTo(starPos.x, starPos.y);
                ctx.stroke();
                ctx.setLineDash([]); // ë¤ì ì¤ì ì¼ë¡ ì¤ì 

                // ì°ì£¼ìì°¨ ê° (ì§ê°ì¼ê°íì ê°)
                // ê°ì A ì§ì ìì ê´ì¸¡ ì (xì¶ ê¸°ì¤)
                const starEarthX = SUN_POS.x + AU_CANVAS_RADIUS * Math.cos(angleA); // Earth A X
                const starEarthY = SUN_POS.y + AU_CANVAS_RADIUS * Math.sin(angleA); // Earth A Y
                
                // ë³-íì-Aì§ì  ê°ë (ì§ê°ì¼ê°í)
                const centerAngle = Math.atan2(starEarthY - starPos.y, starEarthX - starPos.x); // ë³ìì Aë¥¼ ë°ë¼ë³´ë ê°
                const sunAngle = Math.atan2(SUN_POS.y - starPos.y, SUN_POS.x - starPos.x); // ë³ìì íìì ë°ë¼ë³´ë ê° (í­ì -PI/2)
                
                const startAngle = sunAngle; // ë³ìì íì ë°©í¥
                const endAngle = centerAngle; // ë³ìì A ë°©í¥

                ctx.strokeStyle = star.color;
                ctx.lineWidth = 1;
                ctx.beginPath();
                // arc(x, y, radius, startAngle, endAngle)
                const arcRadius = 30; // í¸ì ë°ì§ë¦
                ctx.arc(starPos.x, starPos.y, arcRadius, startAngle, endAngle);
                ctx.stroke();
                
                // ì°ì£¼ìì°¨($p$) íì¤í¸
                const textAngle = (startAngle + endAngle) / 2;
                const textX = starPos.x + (arcRadius + 10) * Math.cos(textAngle);
                const textY = starPos.y + (arcRadius + 10) * Math.sin(textAngle);
                ctx.fillStyle = star.color;
                ctx.font = '14px Noto Sans KR';
                ctx.fillText(`p: ${data.p_arcsec.toFixed(3)}''`, textX, textY);

                // --- ìì (Line of Sight) ê·¸ë¦¬ê¸° ---
                
                // íì¬ ì§êµ¬ ìì¹ìì ë³ê¹ì§ì ìì 
                ctx.strokeStyle = star.color;
                ctx.setLineDash([3, 3]);
                ctx.lineWidth = 1;
                
                // ìì  1: ì§êµ¬ íì¬ ìì¹ -> ë³
                ctx.beginPath();
                ctx.moveTo(earthX, earthY);
                ctx.lineTo(starPos.x, starPos.y);
                
                // ìì  2: ë³ -> ë°°ê²½ ë³ (ììª½ì¼ë¡ ê¸¸ê² ì°ì¥)
                const angleToBackground = Math.atan2(starPos.y - earthY, starPos.x - earthX);
                const backgroundX = earthX + 1000 * Math.cos(angleToBackground);
                const backgroundY = earthY + 1000 * Math.sin(angleToBackground);
                
                ctx.lineTo(backgroundX, backgroundY);
                ctx.stroke();
                
                ctx.setLineDash([]); // ë¤ì ì¤ì ì¼ë¡ ì¤ì 
                
                // ë°°ê²½ ë³ ìì ìì ì´ ë¿ë 'ê²ë³´ê¸°' ìì¹ íì
                ctx.fillStyle = star.color;
                ctx.beginPath();
                ctx.arc(backgroundX, backgroundY, 5, 0, Math.PI * 2);
                ctx.fill();
            });

            ctx.restore(); // ì¤ì¼ì¼ë§/ì´ë ìì ë³µêµ¬
        }

        // --- ì ëë©ì´ì ë£¨í ---
        let lastTime = 0;
        function animate(time) {
            const deltaTime = time - lastTime;
            lastTime = time;

            // ì§êµ¬ ê°ë ìë°ì´í¸
            // ê°ë ê°ì ë°©í¥ì´ ë¶ê·¹ìì ë³¸ ìì ì ë°ìê³ ë°©í¥ ê³µì ì ìë¯¸í©ëë¤.
            earthAngle -= animationSpeed * deltaTime;
            if (earthAngle < 0) {
                earthAngle += Math.PI * 2; // ê°ëê° ììê° ëë©´ 2*PIë¥¼ ëíì¬ 0~2PI ì¬ì´ë¡ ì ì§
            }

            // ìºë²ì¤ ê·¸ë¦¬ê¸°
            drawParallaxDiagram();
            
            // ë°ì´í° ìë°ì´í¸
            updateDataDisplay();

            requestAnimationFrame(animate);
        }

        // --- ë°ì´í° íì ìë°ì´í¸ ---

        function updateDataDisplay() {
            const starX = STARS.find(s => s.id === 'starX');
            const starY = STARS.find(s => s.id === 'starY');
            
            document.getElementById('starXData').innerHTML = 
                `<span class="font-semibold">${starX.name} (ê°ê¹ì´ ë³)</span><br>
                ìì°¨(p): <span class="font-mono">${starX.data.p_arcsec.toFixed(3)}''</span><br>
                ê±°ë¦¬(d): <span class="font-mono">${starX.data.distance_pc.toFixed(3)} pc</span>`;

            document.getElementById('starYData').innerHTML = 
                `<span class="font-semibold">${starY.name} (ë¨¼ ë³)</span><br>
                ìì°¨(p): <span class="font-mono">${starY.data.p_arcsec.toFixed(3)}''</span><br>
                ê±°ë¦¬(d): <span class="font-mono">${starY.data.distance_pc.toFixed(3)} pc</span>`;

             document.getElementById('distanceValue').textContent = `${starX.distance} (ìë ê±°ë¦¬)`;
             document.getElementById('speedValue').textContent = `${animationSpeed.toFixed(3)}x`;
        }

        // --- ì´ë²¤í¸ ë¦¬ì¤ë ---

        const distanceSlider = document.getElementById('distanceSlider');
        distanceSlider.addEventListener('input', (e) => {
            const newDistance = parseFloat(e.target.value);
            const starX = STARS.find(s => s.id === 'starX');
            starX.distance = newDistance;
            // ë³ Yë ê³ ì ë ê° (600)ì ì ì§í©ëë¤.
        });

        const speedSlider = document.getElementById('speedSlider');
        speedSlider.addEventListener('input', (e) => {
            animationSpeed = parseFloat(e.target.value);
        });

        // ì´ê¸° ì¤í
        window.onload = function() {
            animate(0); // ì ëë©ì´ì ìì
        };

    </script>
</body>
</html>

    
